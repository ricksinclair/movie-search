<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <title>Multiple AJAX</title>


</head>

<body>

  <div class="container col-10">


    <div class="col-8" id="Results">
      <div id="results">
        <h1>Results</h1>
      </div>
      <hr class="results-rule" />
      <div></div>
    </div>
  </div>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
    crossorigin="anonymous" />
  <link rel="stylesheet" href="style.css" />

  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>


  <script type="text/javascript">
    var i = 0;
    var x;
    var responseLocal;
    var results;
    var count = 0;
    function pageUpdate() {
      //         1. I want to  increment the page number that I pass to the Ajax call then make an Ajax request to the OMDB on each click of the button
      i++;
      $.ajax({
        url: "https://www.omdbapi.com/?s=" + userQuery + "&page=" + i + "&apikey=trilogy& plot=full",
        method: "GET",
        async: true,
        dataType: 'jsonp'
      }).then(function (response) {
        // 2. After the request is made, once i receive the response I want to set the response to equal the  var resultsLocal.
        // Then set the var results equal to  the array Search.

        responseLocal = response;
        results = responseLocal.Search;
        console.log(results);
        console.log("i is: " + i);
        console.log()
        var div = $("<div>", { "id": i, "class": "row results-rule" });


        $("#results").append(div);
        $("#" + i + "").append("<br><h5>PAGE: " + i + "</h5>");

        // 3. Then I want to  increment through each result (using variable x and setting it to less than 10 so that it will fetch each property i specify  for the full length of each page sent in the  response).

        for (x = 0; x < 10; x++) {
          count++;
          console.log("index of current object Array is: " + x + " Title is:" + results[x].Title);
          var poster = results[x].Poster

          $("#" + i).append("<div class=card style=width: 300px;><img  wclass=card-img-top, img-fluid, img-posterz, src=" + poster + "id=Poster" + x + " alt=card image cap></img><div class=card-body><p style=word wrap: break-word; class=card-title id=title" + x + ">  " + results[x].Title + "</p> <p class=card-text id=h3" + x
            + "> YEAR RELEASED: " + results[x].Year + "</p></div>  <ul class=list-group list-group-flush>" + "    <li class=list-group-item>  ITEM   NUMBER:" + count + "</li></ul></div> ")



        }

      });
    }
    var userQuery = prompt("Enter Your Search String");


    $().ready(function () {


      pageUpdate();


      $("#refresh").click(function () {

        pageUpdate();
      });
    });





    // ---------------------------------------------------------

    console.log("Because our AJAX requests are asynchronous, this line of code will most likely log first");


  </script>
  <button class="btn btn-primary" id="refresh">Refresh</button>

</body>

</html>