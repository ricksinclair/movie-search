<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Multiple AJAX</title>
</head>

<body>
  <div class="col-2"></div>
  <div class="container col-8">
    <div class="col2">

    </div>

    <div class="col-8" id="Results">
      <h1 id="results">Results</h1>
      <hr />
      <div></div>
    </div>
    <div class="col-2"></div>
  </div>
  <div class="col-2"></div>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
    crossorigin="anonymous">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>


  <script type="text/javascript">
    var i = 0;
    var x;
    var responseLocal;
    var results;

    function pageUpdate() {

      i++;
      $.ajax({
        url: "https://www.omdbapi.com/?s=" + userQuery + "&page=" + i + "&apikey=trilogy& plot=full",
        method: "GET",
        async: true,
        dataType: 'jsonp'
      }).then(function (response) {
        // 2. After the request is made, once i receive the response I want to set the response to equal the  var resultsLocal.
        // Then set the var results equal to  the array Search.

        responseLocal = response;
        results = responseLocal.Search;
        console.log(results);
        console.log("i is: " + i + "Title is:" + results[x].Title);
        console.log()
        var div = $("<div>", { "id": i, "class": "row" });


        $("#results").append(div);

        // 3. Then I want to  increment through each result (using variable x and setting it to less than 10 so that it will fetch each property i specify  for the full length of each page sent in the  response).

        for (x = 0; x < 10; x++) {
          console.log("x is: " + x);
          var poster = results[x].Poster

          $("#" + i).append("<div class=col-6><h2 id=title" + x + ">  " + results[x].Title + "</h2><hr><h3 id=h3" + x
            + "> YEAR RELEASED: " + results[x].Year + "</h3><hr><br><hr>" + "<img  class=img-fluid src=" + poster + "id=Poster" + x + "></img><br><hr><br></div> ")



        }
        $("#" + i + "").append("<br><h2>PAGE: " + i + "</h2><br>");

      });
    }
    var userQuery = prompt("Enter Your Search String");


    $().ready(function () {


      pageUpdate();


      $("#refresh").click(function () {
        //         1. I want to  increment the page number that I pass to the Ajax call then make an Ajax request to the OMDB on each click of the button

        pageUpdate();
      });
    });





    // ---------------------------------------------------------

    console.log("Because our AJAX requests are asynchronous, this line of code will most likely log first");


  </script>
  <button class="btn btn-primary" id="refresh">Refresh</button>

</body>

</html>